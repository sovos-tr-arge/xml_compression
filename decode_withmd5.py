

d = {
"1": "cac:PartyIdentification",
"2": 	"cbc:Name",
"3": 	"cbc:CitySubdivisionName",
"4": 	"cbc:TaxAmount",
"5": 	"cbc:ID",
"6": 	"cac:AdditionalDocumentReference",
"7": 	"cac:TaxScheme",
"8": 	"cbc:CalculationSequenceNumeric",
"9": 	"cbc:LineExtensionAmount",
"10": 	"cac:PostalAddress",
"11": 	"cbc:TaxTypeCode",
"12": 	"cbc:TaxableAmount",
"13": 	"cac:TaxSubtotal",
"14": 	"cac:TaxCategory",
"15": 	"cbc:IssueDate",
"16": 	"cbc:ElectronicMail",
"17": 	"ds:DigestValue",
"18": 	"cbc:BuildingNumber",
"19": 	"cac:PartyName",
"20": 	"cbc:CityName",
"21": 	"cbc:StreetName",
"22": 	"cac:Country",
"23": 	"cbc:DocumentTypeCode",
"24": 	"cac:PartyTaxScheme",
"25": 	"cbc:PostalZone",
"26": 	"cbc:EmbeddedDocumentBinaryObject",
"27": 	"cbc:Percent",
"28": 	"xades:SignedSignatureProperties",
"29": 	"cbc:InvoicedQuantity",
"30": 	"cac:DigitalSignatureAttachment",
"31": 	"cac:TaxTotal",
"32": 	"cac:Contact",
"33": 	"cbc:Telephone",
"34": 	"xades:SignedDataObjectProperties",
"35": 	"cbc:Note",
"36": 	"cac:AccountingSupplierParty",
"37": 	"cac:AccountingCustomerParty",
"38": 	"cbc:BuildingName",
"39": 	"xades:QualifyingProperties",
"40": 	"ds:Reference",
"41": 	"xades:SigningCertificate",
"42": 	"cbc:DocumentCurrencyCode",
"43": 	"cbc:WebsiteURI",
"44": 	"cac:InvoiceLine",
"45": 	"cbc:PriceAmount",
"46": 	"ds:DigestMethod",
"47": 	"xades:SignedProperties",
"48": 	"cac:LegalMonetaryTotal",
"49": 	"cbc:TaxExclusiveAmount",
"50": 	"cbc:TaxInclusiveAmount",
"51": 	"cac:ExternalReference",
"52": 	"ext:ExtensionContent",
"53": 	"cbc:LineCountNumeric",
"54": 	"cbc:DocumentType",
"55": 	"xades:DataObjectFormat",
"56": 	"ds:X509SerialNumber",
"57": 	"cbc:CustomizationID",
"58": 	"cbc:InvoiceTypeCode",
"59": 	"cac:Party",
"60": 	"cac:AllowanceCharge",
"61": 	"cbc:ChargeIndicator",
"62": 	"cbc:Telefax",
"63": 	"ds:X509Certificate",
"64": 	"xades:IssuerSerial",
"65": 	"xades:ClaimedRoles",
"66": 	"cac:SignatoryParty",
"67": 	"ext:UBLExtensions",
"68": 	"ds:SignatureValue",
"69": 	"xades:SigningTime",
"70": 	"ds:X509IssuerName",
"71": 	"xades:ClaimedRole",
"72": 	"cbc:CopyIndicator",
"73": 	"cbc:PayableAmount",
"74": 	"cbc:MultiplierFactorNumeric",
"75": 	"cac:SellersItemIdentification",
"76": 	"ext:UBLExtension",
"77": 	"xades:CertDigest",
"78": 	"xades:SignerRole",
"79": 	"cbc:UBLVersionID",
"80": 	"cbc:Region",
"81": 	"cbc:District",
"82": 	"cbc:AllowanceTotalAmount",
"83": 	"ds:RSAKeyValue",
"84": 	"cac:Attachment",
"85": 	"cac:Price",
"86": 	"ds:SignedInfo",
"87": 	"ds:Transforms",
"88": 	"cbc:ProfileID",
"89": 	"cac:Signature",
"90": 	"ds:CanonicalizationMethod",
"91": 	"xades:MimeType",
"92": 	"cac:Item",
"93": 	"ds:Signature",
"94": 	"cbc:Room",
"95": 	"ds:X509Data",
"96": 	"ds:KeyValue",
"97": 	"ds:Exponent",
"98": 	"cbc:PaymentDueDate",
"99": 	"ds:KeyInfo",
"100": 	"ds:Modulus",
"101": 	"xades:Cert",
"102": 	"cbc:Amount",
"103": 	"ds:SignatureMethod",
"104": 	"ds:Object",
"105": 	"cbc:BaseAmount",
"106": 	"cbc:UUID",
"107": 	"cbc:AllowanceChargeReason",
"108": 	"cac:PayeeFinancialAccount",
"109": 	"cbc:URI",
"110": 	"Invoice",
"111": 	"cac:PaymentTerms",
"112": 	"cbc:ChargeTotalAmount",
"113": 	"cac:FinancialInstitutionBranch",
"114": 	"cbc:PaymentMeansCode",
"115": 	"cbc:TaxExemptionReasonCode",
"116": 	"ds:Transform",
"117": 	"cbc:IssueTime",
"118": 	"cac:FinancialInstitution",
"119": 	"cbc:TaxExemptionReason",
"120": 	"cac:PaymentMeans",
"121": 	"cac:WithholdingTaxTotal",
"122": 	"cac:BuyersItemIdentification",
"123": 	"cbc:PayableRoundingAmount",
"124": 	"cbc:CurrencyCode",
"125": 	"cac:DespatchDocumentReference",
"126": 	"cbc:PaymentAlternativeCurrencyCode",
"127": 	"cbc:IdentificationCode",
"128": 	"cbc:PricingCurrencyCode",
"129": 	"cbc:PaymentCurrencyCode",
"130": 	"cbc:SequenceNumeric",
"131": 	"cac:ManufacturersItemIdentification",
"132": 	"cbc:TaxCurrencyCode",
"133": 	"cbc:DocumentDescription",
"134": 	"cbc:SourceCurrencyCode",
"135": 	"cbc:TargetCurrencyCode",
"136": 	"cac:Delivery",
"137": 	"cbc:CalculationRate",
"138": 	"cbc:Description",
"139": 	"ds:X509SubjectName",
"140": 	"cac:AgentParty",
"141": 	"cac:BuyerCustomerParty",
"142": 	"cbc:TransactionCurrencyTaxAmount",
"143": 	"cbc:FamilyName",
"144": 	"cbc:FirstName",
"145": 	"cac:PricingExchangeRate",
"146": 	"cac:OriginCountry",
"147": 	"cac:Person",
"148": 	"cac:AdditionalItemIdentification",
"149": 	"cac:OrderReference",
"150": 	"cbc:BaseUnitMeasure",
"151": 	"cac:DeliveryAddress",
"152": 	"cbc:InstructionNote",
"153": 	"cbc:PerUnitAmount",
"154": 	"cac:DespatchLineReference",
"155": 	"cbc:TransportModeCode",
"156": 	"cac:DocumentReference",
"157": 	"cac:CommodityClassification",
"158": 	"cbc:ItemClassificationCode",
"159": 	"cac:TransportHandlingUnit",
"160": 	"cbc:PaymentNote",
"161": 	"cbc:Date",
"162": 	"cbc:AccountingCost",
"163": 	"cac:PaymentAlternativeExchangeRate",
"164": 	"cac:DeliveryTerms",
"165": 	"cac:ShipmentStage",
"166": 	"cbc:RequiredCustomsID",
"167": 	"cac:PartyLegalEntity",
"168": 	"cbc:RegistrationName",
"169": 	"cac:Shipment",
"170": 	"cbc:DeclaredCustomsValueAmount",
"171": 	"cac:GoodsItem",
"172": 	"cac:PaymentExchangeRate",
"173": 	"cac:ActualPackage",
"174": 	"cbc:PackagingTypeCode",
"175": 	"cac:MaritimeTransport",
"176": 	"cac:PhysicalLocation",
"177": 	"cbc:LineID",
"178": 	"cbc:ModelName",
"179": 	"cbc:CompanyID",
"180": 	"cac:TaxExchangeRate",
"181": 	"cac:TransportMeans",
"182": 	"cbc:DeclaredForCarriageValueAmount",
"183": 	"cac:InvoiceDocumentReference",
"184": 	"cbc:BrandName",
"185": 	"cbc:InsuranceValueAmount",
"186": 	"cbc:VesselID",
"187": 	"cac:Address",
"188": 	"cbc:Keyword",
"189": 	"cac:BillingReference",
"190": 	"cac:DeliveryParty",
"191": 	"cbc:MiddleName",
"192": 	"cbc:PaymentChannelCode",
"193": 	'..\\xsdrt\\maindoc\\UBL-Invoice-2.1.xsd"',
"194": 	'Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"',
"195": 	'Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"',
"196": 	'Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"',
"197": 	'Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"',
"198": 	'Type="http://uri.etsi.org/01903#SignedProperties"',
"199": 	'characterSetCode="UTF-8"',
"200": 	'currencyID="TRY"',
"201": 	'encodingCode="Base64"',
"202": 	'mimeCode="application/xml"',
"203": 	'schemeID="MERSISNO"',
"204": 	'schemeID="TICARETSICILNO"',
"205": 	'schemeID="VKN"',
"206": 	'schemeID="VKN_TCKN"',
"207": 	'unitCode="C62"',
"208": 	'xmlns:cac="urn:oasis:names:specification:ubl:schema:xsd:CommonAggregateComponents-2"',
"209": 	'xmlns:cbc="urn:oasis:names:specification:ubl:schema:xsd:CommonBasicComponents-2"',
"210": 	'xmlns:ds="http://www.w3.org/2000/09/xmldsig#"',
"211": 	'xmlns:ext="urn:oasis:names:specification:ubl:schema:xsd:CommonExtensionComponents-2"',
"212": 	'xmlns:xades="http://uri.etsi.org/01903/v1.3.2#"',
"213": 	'xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"',
"214": 	'xmlns="urn:oasis:names:specification:ubl:schema:xsd:Invoice-2"',
"215": 	'xsi:schemaLocation="urn:oasis:names:specification:ubl:schema:xsd:Invoice-2',
}


def decode_md5(in_file, out_file):

	fin = open(in_file)
	#fin = open("in.xml")
	contents = fin.read()
	fin.close()

	fout = open(out_file, "w")

	s = ""
	save = False

	for c in contents:

		s += c

		if c == '<':
			# begining of a new tagi flush old ones
			if save:
				hash_val = s[:-1]
				#print(hash_val)
				f2 = open("xlst/" + hash_val)
				fout.write(f2.read())
				f2.close()
				s = "<"
			fout.write(s)
			s = ""
		elif c == '>':

			tags = s[:-1].split(" ")

			pre = ""
			post = ""
			s = ""
			parts = []

			for tag in tags:
				if tag[0] == "/":
					tag = tag[1:]
					pre = "/"
				if tag[-1] == "/":
					tag = tag[:-1]
					post = "/"

				if tag == "26":
					save = not save

				#print(tag)
				if tag in d:
					parts.append(pre + str(d[tag]) + post)
				else:
					parts.append (pre + tag + post)

			s += " ".join(parts) + ">"
			fout.write(s)
			s = ""
			

	if s != "":
		fout.write(s)

	fout.close()


if __name__ == "__main__":

	decode_md5("out_md5.xml", "out_md5_2.xml")
	